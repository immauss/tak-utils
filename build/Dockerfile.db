FROM registry1.dso.mil/ironbank/tpc/tak/tak-server-db:latest
# put updated start script in user home directory
RUN mkdir /var/lib/postgresql/scripts
COPY scripts/new-takdb.sh /var/lib/postgresql/scripts/start.sh
# Trailing slash on the source causes the contents of the directory to be copied, not the directory itself
COPY configs/ /opt/tak/  
COPY configs/pg_hba.conf /opt/tak/db-utils/pg_hba.conf
LABEL maintainer="george.e.knauss.ctr@army.mil" \
      version="25.02.01" \
      description="TAK DB from Iron Bank with custom start script"
ENTRYPOINT ["/var/lib/postgresql/scripts/start.sh"]
